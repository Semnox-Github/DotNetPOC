<Window x:Class="Semnox.Parafait.CommonUI.ContextSearchView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
        xmlns:local="clr-namespace:Semnox.Parafait.CommonUI"
        mc:Ignorable="d"
        Style="{StaticResource PopupWindowStyle}"
        Title="ContextSearchView">
    <Grid MinWidth="400"
          x:Name="MainGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="1.5*" />
            <RowDefinition Height="2.5*" />
            <RowDefinition Height="1.5*" />
            <RowDefinition Height="8*" />
        </Grid.RowDefinitions>
        <Grid Grid.Row="0"
              Margin="10,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="9*" />
                <ColumnDefinition Width="1*" />
            </Grid.ColumnDefinitions>
            <local:CustomTextBlock x:Name="tbHeader"
                                              Grid.Column="0"
                                              FontWeight="{StaticResource FontWeight.Bold}"
                                              Margin="{StaticResource ContextSearchTextBlockMargin}"
                                              Text="{Binding Heading}" />
            <Button x:Name="btnClose"
                    Grid.Column="1"
                    BorderThickness="0"
                    Background="Transparent"
                    Margin="0,0,10,0"
                    CommandParameter="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=Window}}"
                    Command="{Binding CloseCommand}">
                <Button.Style>
                    <Style TargetType="{x:Type Button}">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type Button}">
                                    <Border Background="Transparent">
                                        <Grid>
                                            <Path Data="M0 0H32V32H0z" />
                                            <Path Data="M28 6.667L18.667 16 28 25.333 25.333 28 16 18.667 6.667 28 4 25.333 13.333 16 4 6.667 6.667 4 16 13.333 25.333 4z"
                                                  Fill="{StaticResource Control.Heading.ForeGround}" />
                                        </Grid>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Button.Style>
            </Button>
        </Grid>

        <Grid Grid.Row="1"
              Margin="10,0,10,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="8.5*" />
                <ColumnDefinition Width="1.5*" />
            </Grid.ColumnDefinitions>
            <local:CustomSearchTextBox  x:Name="txtSearch"
                                                   Grid.Column="0"
                                                   DefaultValue="{Binding TextBoxDefaultValue}"
                                                   Text="{Binding Path=SearchText,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                   TextChanged="txtSearch_TextChanged" />
            <Button Grid.Column="1"
                    Height="72"
                    Margin="10"
                    x:Name="btnKeyBoard">
                <Button.Style>
                    <Style TargetType="{x:Type Button}">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type Button}">
                                    <Border x:Name="border"
                                            BorderBrush="{StaticResource Control.BorderBrush}"
                                            BorderThickness="0,0,0,3"
                                            CornerRadius="{StaticResource CornerRadius}"
                                            Background="{TemplateBinding Background}">
                                        <Grid Margin="8"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center">
                                            <Path Data="M0 0H54V32H0z" />
                                            <Path Data="M50.4 32c1.997 0 3.6-1.583 3.6-3.556V3.556C54 1.583 52.397 0 50.4 0H3.6C1.603 0 0 1.583 0 3.556v24.888C0 30.417 1.603 32 3.6 32h46.8zm0-3.556H3.6V3.556h46.8v24.888zM10.35 10.667c.253 0 .45-.195.45-.445V7.556c0-.25-.197-.445-.45-.445h-2.7c-.253 0-.45.195-.45.445v2.666c0 .25.197.445.45.445h2.7zm7.2 0c.253 0 .45-.195.45-.445V7.556c0-.25-.197-.445-.45-.445h-2.7c-.253 0-.45.195-.45.445v2.666c0 .25.197.445.45.445h2.7zm7.2 0c.253 0 .45-.195.45-.445V7.556c0-.25-.197-.445-.45-.445h-2.7c-.253 0-.45.195-.45.445v2.666c0 .25.197.445.45.445h2.7zm7.2 0c.253 0 .45-.195.45-.445V7.556c0-.25-.197-.445-.45-.445h-2.7c-.253 0-.45.195-.45.445v2.666c0 .25.197.445.45.445h2.7zm7.2 0c.253 0 .45-.195.45-.445V7.556c0-.25-.197-.445-.45-.445h-2.7c-.253 0-.45.195-.45.445v2.666c0 .25.197.445.45.445h2.7zm7.2 7.11c.253 0 .45-.194.45-.444V7.556c0-.25-.197-.445-.45-.445h-2.7c-.253 0-.45.195-.45.445v6.666h-3.15c-.253 0-.45.195-.45.445v2.666c0 .25.197.445.45.445h6.3zm-32.4 0c.253 0 .45-.194.45-.444v-2.666c0-.25-.197-.445-.45-.445h-6.3c-.253 0-.45.195-.45.445v2.666c0 .25.197.445.45.445h6.3zm7.2 0c.253 0 .45-.194.45-.444v-2.666c0-.25-.197-.445-.45-.445h-2.7c-.253 0-.45.195-.45.445v2.666c0 .25.197.445.45.445h2.7zm7.2 0c.253 0 .45-.194.45-.444v-2.666c0-.25-.197-.445-.45-.445h-2.7c-.253 0-.45.195-.45.445v2.666c0 .25.197.445.45.445h2.7zm7.2 0c.253 0 .45-.194.45-.444v-2.666c0-.25-.197-.445-.45-.445h-2.7c-.253 0-.45.195-.45.445v2.666c0 .25.197.445.45.445h2.7zm-25.2 7.112c.253 0 .45-.195.45-.445v-2.666c0-.25-.197-.445-.45-.445h-2.7c-.253 0-.45.195-.45.445v2.666c0 .25.197.445.45.445h2.7zm28.8 0c.253 0 .45-.195.45-.445v-2.666c0-.25-.197-.445-.45-.445h-24.3c-.253 0-.45.195-.45.445v2.666c0 .25.197.445.45.445h24.3zm7.2 0c.253 0 .45-.195.45-.445v-2.666c0-.25-.197-.445-.45-.445h-2.7c-.253 0-.45.195-.45.445v2.666c0 .25.197.445.45.445h2.7z"
                                                  Fill="{StaticResource Control.BorderBrush.Focused}" />
                                        </Grid>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Button.Style>
            </Button>
        </Grid>

        <local:CustomTextBlock x:Name="tbResultContent"
                                          FontWeight="{StaticResource FontWeight.Bold}"
                                          Margin="{StaticResource ContextSearchTextBlockMargin}"
                                          Text="{Binding ResultCountText}"
                                          Grid.Row="2" />

        <local:CustomScrollViewer Grid.Row="3"
                                             HorizontalScrollBarVisibility="Disabled"
                                             VerticalScrollBarVisibility="Auto"
                                             Margin="0,0,20,20">
            <ListBox x:Name="lbSearchedItems"
                     ItemsSource="{Binding SearchParams}"
                     BorderThickness="0"
                     Margin="10,0,10,0"
                     SelectedItem="{Binding SelectedParam, Mode=TwoWay}">
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="SelectionChanged">
                        <i:InvokeCommandAction CommandParameter="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=Window}}"
                                               Command="{Binding SelectedItemCommand}" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>
                <ListBox.ItemContainerStyle>
                    <Style x:Name="ListBoxItemBackgroundBorder"
                           TargetType="ListBoxItem">
                        <Setter Property="Background"
                                Value="{StaticResource ContextSearch.SelectedItem.Background}" />
                        <Setter Property="Margin"
                                Value="0,0,0,8" />
                        <Style.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius"
                                        Value="{StaticResource CornerRadius}" />
                            </Style>
                        </Style.Resources>
                        <Style.Triggers>
                            <Trigger Property="IsSelected"
                                     Value="True">
                                <Setter Property="BorderBrush"
                                        Value="{StaticResource Control.BorderBrush.Focused}" />
                                <Setter Property="BorderThickness"
                                        Value="1" />
                            </Trigger>
                            <Trigger Property="IsSelected"
                                     Value="False">
                                <Setter Property="Background"
                                        Value="{StaticResource ContentAreaItem.Background}" />
                                <Setter Property="BorderBrush"
                                        Value="{StaticResource Control.BorderBrush}" />
                                <Setter Property="BorderThickness"
                                        Value="{StaticResource ContentArea.Items.BorderThickness}" />
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </ListBox.ItemContainerStyle>
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch">
                            <local:CustomTextBlock x:Name="tbListBoxDisplayItem"
                                                              TextTrimming="CharacterEllipsis"
                                                              FontWeight="{StaticResource FontWeight.Bold}"
                                                              Margin="{StaticResource ContextSearchTextBlockMargin}"
                                                              Text="{Binding DisplayName}" />
                        </StackPanel>
                    </DataTemplate>
                </ListBox.ItemTemplate>
                <ListBox.Style>
                    <Style TargetType="{x:Type ListBox}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding RelativeSource={x:Static RelativeSource.Self}, Path=Items.Count}"
                                         Value="0">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate>
                                            <local:CustomTextBlock x:Name="tbNoItems"
                                                                              FontWeight="{StaticResource FontWeight.Bold}"
                                                                              Margin="{StaticResource ContextSearchTextBlockMargin}">
                                                No items to display.
                                            </local:CustomTextBlock>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ListBox.Style>
            </ListBox>
        </local:CustomScrollViewer>
    </Grid>
</Window>
